# ~~ Generated by projen. To modify, edit .projenrc.ts and run "npx projen".

name: upgrade-main
on:
  schedule:
    - cron: 15 0 * * MON-FRI
  workflow_dispatch: {}
  push:
    branches:
      - main
    paths:
      - renovate.json5
      - .github/workflows/renovate.yml
  issues:
    types:
      - edited
  pull_request:
    types:
      - edited
concurrency:
  group: ${{ github.workflow }}-${{ github.event_name == 'workflow_dispatch' && github.event_name || '' }}
jobs:
  upgrade-main:
    runs-on: ubuntu-latest
    permissions:
      contents: read
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Self-hosted Renovate
        uses: renovatebot/github-action@v41.0.12
        if: (github.event_name != 'issues' && github.event_name != 'pull_request') || github.actor != 'cu-infra-svc-git'
        with:
          configurationFile: renovate.json5
          token: x-access-token:${{ secrets.RENOVATEBOT_GITHUB_TOKEN }}
        env:
          RENOVATE_HOST_RULES: '[{"matchHost":"https://npm.pkg.github.com/","hostType":"npm","token":"${{ secrets.ALL_PACKAGE_READ_TOKEN }}"}]'
          RENOVATE_NPMRC: "@${{ github.repository_owner }}:registry=https://npm.pkg.github.com"
          RENOVATE_ENABLED_MANAGERS: '["npm"]'
          RENOVATE_REPOSITORIES: '["${{ github.repository }}"]'
          RENOVATE_FORCE: ${{ github.event_name == 'workflow_dispatch' && '{"schedule":null}' || '' }}
